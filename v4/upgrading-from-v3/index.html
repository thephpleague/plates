<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
        <title>Upgrading from V3 - Plates</title>
    
    
        <meta name="description" content="Plates is a Twig inspired, native PHP template system that brings modern template language functionality to native PHP templates.">
    
    
    
        <link rel="icon" type="image/x-icon" href="/v4/favicon.ico" />
    
    
        <link rel="apple-touch-icon-precomposed" href="/v4/apple-touch-icon-precomposed.png">
    
    <link rel="stylesheet" href="http://theme.thephpleague.com/css/all.css">
    <link rel="stylesheet" href="/v4/css/custom.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
</head>
<body>

<a href="https://github.com/thephpleague/plates" class="github">
    <img src="https://camo.githubusercontent.com/365986a132ccd6a44c23a9169022c0b5c890c387/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png">
</a>

<section class="all_packages">
    <a href="http://thephpleague.com/">
        <img src="http://theme.thephpleague.com/img/loep_logo.png" width="195" height="200" alt="The League of Extraordinary Packages">
    </a>
    <h2>Our Packages:</h2>
    <ul>
        <!-- Loaded via JavaScript -->
    </ul>
</section>

<header>
    <a class="logo" href="/">
        
            <span class="icon">
                <img src="/v4/logo.png" width="50" height="40" alt="Plates - Native PHP Templates">
            </span>
        
        <span class="name">Plates</span>
        <span class="tagline">Native PHP Templates</span>
    </a>
    <a href="http://thephpleague.com/" class="league">
        Presented by The League of Extraordinary Packages
    </a>
</header>

<input type="checkbox" id="menu">
<label for="menu" onclick>
    <div class="closed">&#9776; Menu</div>
    <div class="open">&#9776; Hide Menu</div>
</label>

<main>
    <menu>
        
        <div class="version-select">
            <select class="version-select select2" style="width: 100%" data-minimum-results-for-search="5">
            
                
                <option value="v4" selected="selected">
                
                    V4 Pre-alpha
                </option>
            
                
                <option value="v3">
                
                    V3
                </option>
            
            </select>
        </div>
        
        
            <h2>Getting Started</h2>
            <ul>
                
                    <li >
                        <a href="/v4/">Introduction</a>
                    </li>
                
                    <li >
                        <a href="/v4/installation/">Installation</a>
                    </li>
                
                    <li >
                        <a href="/v4/simple-example/">Simple example</a>
                    </li>
                
                    <li class="selected">
                        <a href="/v4/upgrading-from-v3/">Upgrading from V3</a>
                    </li>
                
                    <li >
                        <a href="/v4/changelog/">Changelog</a>
                    </li>
                
            </ul>
        
            <h2>The Engine</h2>
            <ul>
                
                    <li >
                        <a href="/v4/engine/">Overview</a>
                    </li>
                
                    <li >
                        <a href="/v4/engine/extensions/">Extensions</a>
                    </li>
                
                    <li >
                        <a href="/v4/engine/framework-integration/">Framework Integration</a>
                    </li>
                
            </ul>
        
    </menu>
    <article>
        <h1 id="upgrading-from-v3">Upgrading from V3</h1>

<p>Version 4 of plates has been completely redesigned from the ground up. There are some significant differences that will need to be addressed if you are familiar with v3.</p>

<h2 id="creating-engines">Creating Engines</h2>

<p>The default constructor now longer accepts the templates path and extension. This has been moved over to the <code class="highlighter-rouge">create</code> static constructor. Also, the default extension for templates is <code class="highlighter-rouge">phtml</code> instead of <code class="highlighter-rouge">php</code>, so if you migrating an existing codebase, you’ll need to explicitly set the extension.</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- new League\Plates\Engine('/path/to/templates')
</span><span class="gi">+ League\Plates\Engine::create('/path/to/templates', 'php')
</span></code></pre></div></div>

<h2 id="render-context">Render Context</h2>

<p>Templates no longer rendered within the context of the <code class="highlighter-rouge">Template</code>. This has been replaced by the <code class="highlighter-rouge">RenderContext</code> which is just an object injected into each template. The default name for the render context is <code class="highlighter-rouge">$v</code>, but this is configurable.</p>

<p>So in your templates, you’ll want to change:</p>

<div class="language-diff highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gd">- &lt;?=$this-&gt;section()?&gt;
</span><span class="gi">+ &lt;?=$v-&gt;section()?&gt;
</span></code></pre></div></div>

<p>The <code class="highlighter-rouge">RenderContext</code> is more powerful and flexible than the original Template class because it’s completely configurable.</p>

<p>For BC reasons, we are currently binding <code class="highlighter-rouge">$this</code> to the render context which means <code class="highlighter-rouge">$this === $v</code> when inside of your templates.</p>

<h2 id="templates">Templates</h2>

<p>The <code class="highlighter-rouge">Template</code> class is completely different and has been moved to <code class="highlighter-rouge">Leauge\Plates\Template</code>. In v3, the Template class was responsible for rendering the php files and providing context within the templates themselves. This behavior has been moved into the <code class="highlighter-rouge">RenderTemplate</code> implementations. Templates are now simply immutable value objects.</p>

<p>So this means you can no longer manually create and render templates, you need a <code class="highlighter-rouge">RenderTemplate</code> to actuall render the template into a string.</p>

<div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$renderTemplate</span> <span class="o">=</span> <span class="nx">League\Plates\Engine</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">'/path/to/templates'</span><span class="p">)</span>
    <span class="o">-&gt;</span><span class="na">getContainer</span><span class="p">()</span>
    <span class="o">-&gt;</span><span class="na">get</span><span class="p">(</span><span class="s1">'renderTemplate'</span><span class="p">);</span>

<span class="k">echo</span> <span class="nv">$renderTemplate</span><span class="o">-&gt;</span><span class="na">renderTemplate</span><span class="p">(</span>
    <span class="k">new</span> <span class="nx">League\Plates\Template</span><span class="p">(</span><span class="s1">'profile'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'name'</span> <span class="o">=&gt;</span> <span class="s1">'Jonathan'</span><span class="p">])</span>
<span class="p">);</span>
</code></pre></div></div>

<p>However, this is exactly what the Engine render method does, so you might as well just refactor to use the Engine’s render method.</p>

<h2 id="extension-interface">Extension Interface</h2>

<p>The new interface is located here: <code class="highlighter-rouge">League\Plates\Extension</code>. The contents of the interface are exactly the same. We’ve kept the <code class="highlighter-rouge">League\Plates\Extension\ExtensionInterface</code> around as an alias to the former, but it is deprecated and will be removed in v4.1.</p>

<h2 id="accessing-the-engine-and-template-in-extensions">Accessing the engine and template in Extensions</h2>

<p>This paradigm no longer exists with v4 due to how template functions work now. Functions in v4 now accept the <code class="highlighter-rouge">League\Plates\Extension\RenderContext\FuncArgs</code> as the only argument which has access to the RenderTemplate and curren template instance. Since v4 also utilizes an IoC container, any dependencies needed can be injected into the function constructor. So instead of a func having access to the entire engine, they can just receive the deps they need.</p>

<h2 id="bc-extension">BC Extension</h2>

<p>To do - reference the <a href="https://github.com/thephpleague/plates/issues/214">BCExtension</a> once it gets built.</p>


    </article>
</main>

<footer>
    <span>&copy; Copyright <a href="http://thephpleague.com">The League of Extraordinary Packages</a>.</span>
    <span>Site design by <a href="http://reinink.ca">Jonathan Reinink</a>.</span>
</footer>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="http://theme.thephpleague.com/js/scripts.js"></script>
<script src="http://theme.thephpleague.com/js/prism.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
<script>
$('select.select2').select2().on('change', function(e) {
    var pathParts = window.location.pathname.split("/");
    pathParts[1] = e.currentTarget.value;
    window.location.href = pathParts.join("/");
});
</script>


    <script>
        (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
        function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
        e=o.createElement(i);r=o.getElementsByTagName(i)[0];
        e.src='//www.google-analytics.com/analytics.js';
        r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
        ga('create','UA-46050814-2');ga('send','pageview');
    </script>


</body>
</html>
